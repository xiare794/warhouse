<!DOCTYPE html><html lang="cn">  <head>    <meta charset="utf-8">	<meta http-equiv="Content-Type" content="text/html"; charset="utf-8">  </head>	<body>	<?php		include "_db.php";		global $connection;				//取出可用wpAgentID		$agentsPool= array();		$query = "SELECT * FROM `wAgents` WHERE 1";		$result = mysqli_query($connection, $query);			if(!$result){			 echo '[we have a problem]: '.mysqli_error($connection);			}			while($row = mysqli_fetch_array($result)){				//var_dump($row);				array_push ($agentsPool,$row);				//array_push($trays,$row["wtID"]);			}		//test Echo 		//var_dump($agentsPool);		echo "<p>从".count($agentsPool)."个代理中随机抽取一个</p>";		$theAgent = $agentsPool[rand(0,count($agentsPool)-1)];		echo "<p>取出代理".$theAgent['waID']."-<".$theAgent['waName'].">作为选用代理";						//从托盘中抽取一个作为选用托盘 wpCurrTrayID		//创建空托盘 语句//		$query = "INSERT INTO wTrays VALUES (null, '空闲', null, null,null,null)";//		for($i =0; $i<50; $i++){//			$result = mysqli_query($connection, $query);//			if(!$result){//			 echo '[we have a problem]: '.mysqli_error($connection);//			}//			else{//				echo "<br>创建了一个托盘";//			}//		}				//选出一个托盘		$query = "SELECT * FROM `wTrays` WHERE twStatus='空闲' ";		$trayPool = array();		$result = mysqli_query($connection, $query);		if(!$result){		 echo '[we have a problem]: '.mysqli_error($connection);		}		while($row = mysqli_fetch_array($result)){			//var_dump($row);			array_push ($trayPool,$row);		}		$theTray = $trayPool[rand(0,count($trayPool)-1)];		echo "<p>一共".count($trayPool)."个空闲托盘，选中<".$theTray['wtID']."-".$theTray['twStatus']."></p>";		//并将托盘实例化				//wpLossStatus = "无损，包装损坏，货品轻微损坏"		//选择一个损失状态		$lsPool = array("无损","无损","无损","无损","无损","无损","包装损坏","货品轻微损坏");		$thewpLossStauts = $lsPool[rand(0,count($lsPool)-1)];		echo $thewpLossStauts;				//wpLocked 货物包锁定状态				$thewpLocked = "false";		$NamePool =array("电视","音响","平板电视","迷你音响影音播放器","家庭影院功放设备配件",						"大家电","空调冰箱冰柜","洗衣机烘干机油烟机","燃气灶烟灶","热水器酒柜",						"消毒柜洗碗机","厨房电器","电饭煲电压力锅","蒸煮锅电炖锅","电炖盅电水壶",						"豆浆机咖啡机","搅拌/榨汁机","面包机酸奶","米酒机豆芽机茶饮机","电磁炉微波炉",						"光波炉电烤箱","电饼铛/三明治机烧烤炉","居家电器空气净化器","吸尘器电熨斗",						"加湿器取暖器","饮水机除湿机","挂烫机电风扇","净水设备","个护电器","电动剃须刀",						"电动牙刷","电动美容器","耳鼻毛修剪器","电吹风电子秤","电动理发器","电动剃毛器/脱毛器");		$thewpFullName = $NamePool[rand(0,count($NamePool)-1)];		echo "<br>商品是".$thewpFullName;								//商品数量 wpCount单位件		$wpCount = rand(0,10);		echo "<br>共计".$wpCount."件";				//商品包装规格 wpPackageStander		$packPool =array("a","b","c","d","e","f","g","h");		$wpPackageStander = $packPool[rand(0,7)];		echo "<br>包装为：标准".$wpPackageStander."类包装";				//报关状态 		$cusPool = array("已报关","已报关","已报关","已报关","未报关");		$wpCustomerStatus = $cusPool[rand(0,4)];		echo "<br>".$wpCustomerStatus;		//唛头		$wpMAITOU = mb_substr($thewpFullName,0,3,'utf-8');		echo "<br>唛头为<-".$wpMAITOU.">";		//总重量 kg		$wpTotalWeight = rand(10,100)*rand(1,5);		echo "<br>共计".$wpTotalWeight."kg";				//体积 省略算法 每100kg 一立方米		$wpVolume = ceil ($wpTotalWeight/100);		echo "<br>共计".$wpVolume."立方米";				//已存储多少天 wpInStockDays {1,60};		$wpTotalWeight = rand(1,60);		echo "<br>在库".$wpTotalWeight."天";				//计划存储天数 wpPlanDays {60,120};		$wpPlanDays = rand(30,120);		echo "<br>计划存储".$wpPlanDays."天";				$wNotePrivate = "代理<".$theAgent['waID']."-".$theAgent['waName'].">,商品是".$thewpFullName.",共计".$wpCount."件,标准".$wpPackageStander."类包装,".$wpCustomerStatus.						"唛头为<-".$wpMAITOU.">"."共计".$wpTotalWeight."kg,"."共计".$wpVolume."立方米,"."在库".$wpTotalWeight."天"."计划存储".$wpPlanDays."天";		echo "<br>".$wNotePrivate;				$wNotePublic = "无记录";				$queryVari = "wpAgentID,wpCurrTrayID,wpLossStatus,wpLocked,wpFullName,wpCount,wpPackageStander,wpCustomerStatus,wpMAITOU,wpTotalWeight,wpVolume,wpPlanDays,wNotePrivate,wNotePublic";		$queryData = array($theAgent['waID'],$theTray['wtID'],$thewpLossStauts,$thewpLocked,$thewpFullName,$wpCount,$wpPackageStander,$wpCustomerStatus,$wpMAITOU,$wpVolume,$wpTotalWeight,$wpPlanDays,$wNotePrivate,$wNotePublic);		//theAgent,theTray,thewpLossStauts,thewpLocked,thewpFullName,wpCount,wpPackageStander,wpCustomerStatus,wpMAITOU,wpTotalWeight,wpVolume,wpTotalWeight,wpPlanDays,wNotePrivate,wNotePublic				//INSERT INTO table_name (column1, column2, column3,...)		//VALUES (value1, value2, value3,...)		$query = "INSERT INTO warePackages ( ".$queryVari." ) ";		$query .= " VALUES(";		for($i =0; $i<(count($queryData)); $i++){			$query .= "\"".$queryData[$i]."\"";			//var_dump( $queryData[$i]);			if($i != count($queryData)-1)				$query .= ",";		}		//$query .= $theAgent.",".$theTray.",".$thewpLossStauts.",".$thewpLocked.",".$thewpFullName.",".$wpCount.",".$wpPackageStander.",".$wpCustomerStatus.",".$wpMAITOU.",".$wpTotalWeight.",".$wpVolume.",".$wpTotalWeight.",".$wpPlanDays.",".$wNotePrivate.",".$wNotePublic;		$query .= ");";		$result = mysqli_query($connection, $query);		//echo "注意这".mysqli_insert_id($connection)."//";		//echo mysqli_affected_rows($connection);		if(!$result){		 echo '[we have a problem]: '.mysqli_error($connection);		}		else{			echo "成功新建--wpID为".mysqli_insert_id($connection);		}		$wpID = mysqli_insert_id($connection);				//修改使用的托盘Tray		$query = "UPDATE wTrays SET ";		$query .= "twStatus = \"使用中\", wpID = ".$wpID." ";		$query .= "WHERE wtID = ".$theTray['wtID'];		echo "<br>".$query;		$result = mysqli_query($connection, $query);		if(!$result){		 echo '[we have a problem]: '.mysqli_error($connection);		}		else{			echo "推盘修改成功";		}		echo "推盘修改的ID为".mysqli_affected_rows($connection)."//";					?>	</body></html>	